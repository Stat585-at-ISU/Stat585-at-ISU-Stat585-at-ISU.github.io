<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Heike Hofmann">

<title>Stat 585 - Lab Assignment #2: Getting that data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Stat 585</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../schedule.html">
 <span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../blog.html">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../labs.html">
 <span class="menu-text">Labs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../projects.html">
 <span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://canvas.iastate.edu/courses/98137">
 <span class="menu-text">Canvas (ISU)</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://canvas.unl.edu/courses/150086">
 <span class="menu-text">Canvas (UNL)</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#outline" id="toc-outline" class="nav-link active" data-scroll-target="#outline">Outline</a></li>
  <li><a href="#lab-organization" id="toc-lab-organization" class="nav-link" data-scroll-target="#lab-organization">Lab organization</a></li>
  <li><a href="#first-item-talk" id="toc-first-item-talk" class="nav-link" data-scroll-target="#first-item-talk">First item: talk!</a></li>
  <li><a href="#our-goal-for-this-lab" id="toc-our-goal-for-this-lab" class="nav-link" data-scroll-target="#our-goal-for-this-lab">Our Goal for this lab</a></li>
  <li><a href="#service-calls-to-the-ames-police" id="toc-service-calls-to-the-ames-police" class="nav-link" data-scroll-target="#service-calls-to-the-ames-police">Service calls to the Ames police</a></li>
  <li><a href="#download-the-press-log-file" id="toc-download-the-press-log-file" class="nav-link" data-scroll-target="#download-the-press-log-file">Download the Press log file</a></li>
  <li><a href="#reading-a-pdf-file" id="toc-reading-a-pdf-file" class="nav-link" data-scroll-target="#reading-a-pdf-file">Reading a pdf file</a></li>
  <li><a href="#extract_tables" id="toc-extract_tables" class="nav-link" data-scroll-target="#extract_tables"><code>extract_tables</code></a></li>
  <li><a href="#transform-the-plog-object-into-a-clean-data-set" id="toc-transform-the-plog-object-into-a-clean-data-set" class="nav-link" data-scroll-target="#transform-the-plog-object-into-a-clean-data-set">Transform the <code>plog</code> object into a clean data set</a></li>
  <li><a href="#helper-files-and-code" id="toc-helper-files-and-code" class="nav-link" data-scroll-target="#helper-files-and-code">Helper files and code</a></li>
  <li><a href="#how-robust-is-your-code" id="toc-how-robust-is-your-code" class="nav-link" data-scroll-target="#how-robust-is-your-code">How robust is your code?</a></li>
  <li><a href="#deliverables-1-or-2" id="toc-deliverables-1-or-2" class="nav-link" data-scroll-target="#deliverables-1-or-2">Deliverables (1) or (2)</a>
  <ul class="collapse">
  <li><a href="#deliverable-1" id="toc-deliverable-1" class="nav-link" data-scroll-target="#deliverable-1">Deliverable (1)</a></li>
  <li><a href="#deliverable-2" id="toc-deliverable-2" class="nav-link" data-scroll-target="#deliverable-2">Deliverable (2)</a></li>
  </ul></li>
  <li><a href="#submit" id="toc-submit" class="nav-link" data-scroll-target="#submit">Submit</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab Assignment #2: Getting that data</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Heike Hofmann </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="outline" class="level1">
<h1>Outline</h1>
<ul>
<li><p><code>pdf</code> files are for text, right?</p></li>
<li><p>Looking under the hood …</p></li>
</ul>
<p>The final deliverable is again a self-contained RMarkdown file and a dataset.</p>
<hr>
</section>
<section id="lab-organization" class="level1">
<h1>Lab organization</h1>
<ol type="1">
<li><p>As last time, there is a github classroom link. Select the invite with your team’s number.</p></li>
<li><p>Hofmann, don’t forget the Zoom breakout rooms. Join the room that matches your team number.</p></li>
<li><p>Final deliverable: submit a link to your repository in Canvas (This will show me that you are done working on your project).</p></li>
<li><p>Create a folder <code>data</code> in the repository. Assume that all of the data files used are inside this folder, similar to the code used in this Rmarkdown file.</p></li>
</ol>
<hr>
</section>
<section id="first-item-talk" class="level1">
<h1>First item: talk!</h1>
<p>Just as with lab #1, you are asked to create one file (README.Rmd) with your results.</p>
<p>All team members are supposed to contribute … last time you might have realized that it is a pretty big mess if everybody writes into the README file all at the same time.</p>
<p>This time: figure out a plan before you start working. Include your plan as a table in the README.Rmd file for lab #2.</p>
<hr>
</section>
<section id="our-goal-for-this-lab" class="level1">
<h1>Our Goal for this lab</h1>
<ul>
<li><p>read a pdf file into an R session</p></li>
<li><p>go through cleaning steps to turn the pdf into usable information</p></li>
<li><p>save the resulting code and data files</p></li>
</ul>
<hr>
</section>
<section id="service-calls-to-the-ames-police" class="level1">
<h1>Service calls to the Ames police</h1>
<p>are collected and published each day for a time interval of the past four days as ‘Press log’</p>
<p>https://www.cityofames.org/government/departments-divisions-i-z/police/news-and-updates</p>
<p>available under</p>
<p>https://data.city.ames.ia.us/publicinformation/PressLog.pdf</p>
<hr>
</section>
<section id="download-the-press-log-file" class="level1">
<h1>Download the Press log file</h1>
<p>and inspect it …</p>
<div class="cell" data-hash="02_lab_2023_cache/html/unnamed-chunk-1_4228d5579da959da15aac875e6adbf84">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>presslog_url <span class="ot">&lt;-</span> <span class="st">"https://data.city.ames.ia.us/publicinformation/PressLog.pdf"</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">download.file</span>(presslog_url, <span class="at">destfile =</span> <span class="st">"PressLog.pdf"</span>, <span class="at">mode =</span> <span class="st">"wb"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="reading-a-pdf-file" class="level1">
<h1>Reading a pdf file</h1>
<p>The package <code>tabulizer</code> provides bindings (i.e.&nbsp;wrapper functionalities) for the java library Tabula PDF Table Extractor.</p>
<p>Our first goal for the lab is to install the <code>tabulizer</code> package.</p>
<p>Go to https://docs.ropensci.org/tabulizer/ and follow the directions for installing the package</p>
<hr>
</section>
<section id="extract_tables" class="level1">
<h1><code>extract_tables</code></h1>
<p>The function <code>extract_tables</code> returns a list object.</p>
<p>Describe the structure of this list:</p>
<ul>
<li><p>What does the length of the list correspond to?</p></li>
<li><p>What objects are the list’s items?</p></li>
<li><p>What are the dimensions of each of the list’s items?</p></li>
</ul>
<div class="cell" data-hash="02_lab_2023_cache/html/unnamed-chunk-2_0150dff78b2d23bcbd3341a8bacc174e">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tabulizer)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>plog <span class="ot">&lt;-</span> <span class="fu">extract_tables</span>(<span class="at">file=</span><span class="st">"PressLog.pdf"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(plog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="transform-the-plog-object-into-a-clean-data-set" class="level1">
<h1>Transform the <code>plog</code> object into a clean data set</h1>
<p>Data set of service calls:</p>
<ul>
<li><p>format of object is data frame or tibble</p></li>
<li><p>columns are variables with appropriate names</p></li>
<li><p>each row corresponds to one incident</p></li>
<li><p>all variables have the correct format</p></li>
<li><p>save the result as a csv file with the name “presslog-yyyymmdd.csv’, where yyyymmdd is the date of first reported incident the file</p></li>
</ul>
<hr>
</section>
<section id="helper-files-and-code" class="level1">
<h1>Helper files and code</h1>
<p>Data set of call codes:</p>
<ul>
<li><p>data frame (or tibble) with two columns named ‘Abbreviation’ and ‘Description’</p></li>
<li><p>save the result as a csv file with the name “call-codes.csv”</p></li>
</ul>
<p>Save the code (just the R script, not an Rmd) in a file called “process_presslog_yyyymmdd.R”</p>
<hr>
</section>
<section id="how-robust-is-your-code" class="level1">
<h1>How robust is your code?</h1>
<p>The folder ‘Presslogs’ contains service call files from a couple of other days.</p>
<p>Process these files as well. Do you need to make any adjustments to your code? Keep track of those adjustments.</p>
<p>Save data and code for these presslogs as:</p>
<ul>
<li>“presslog-yyyymmdd.csv”</li>
<li>“process_presslog_yyyymmdd.R”</li>
</ul>
<hr>
</section>
<section id="deliverables-1-or-2" class="level1">
<h1>Deliverables (1) or (2)</h1>
<section id="deliverable-1" class="level2">
<h2 class="anchored" data-anchor-id="deliverable-1">Deliverable (1)</h2>
<p>Create a markdown table with a description of the structure of your repository (i.e.&nbsp;which files are where, and what is included). The structure is not going to be graded itself, just your description of the structure. You will find that good structures are easier to describe :)</p>
<p>Combine all of your service call data sets into one, draw a barchart of the number of service calls by day, colour by service log file.</p>
</section>
<section id="deliverable-2" class="level2">
<h2 class="anchored" data-anchor-id="deliverable-2">Deliverable (2)</h2>
<p>In case things went horribly wrong, and you could not get things to work, describe what you did, which error you encountered, and what strategies you tried before you gave up/ the time for the lab was up.</p>
<hr>
</section>
</section>
<section id="submit" class="level1">
<h1>Submit</h1>
<p><br></p>
<p>Push your changes to the repository, make sure that the <strong>README.Rmd file knits</strong> on your machines, push the <strong>README.md</strong> file as well.</p>
<p>Make sure to add all datasets and all code files to the repository.</p>
<p>Upload a link to your repository to Canvas. Only one submission per team is required. Finishing touches can be made until Monday, Feb 20, 11:59 pm.</p>
<p><br> <br> <br> And you are done!</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>